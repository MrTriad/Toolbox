# 2. SCANNING
Scanning itself is not the actual intrusion, but an extended form of reconnaissance in which the ethical hacker and pen tester learns more about the target, including information about open ports and services, OSes, and any configuration lapses. The information gleaned from this reconnaissance helps you to select strategies for the attack on the target system or network.

<a href="https://www.stationx.net/nmap-cheat-sheet/" style="color:white">nmap</a>
Elenco delle opzioni  disponibile [qui](https://nmap.org/man/it/man-briefoptions.html).

## Host Discovery Phase
During the network scanning phase of security assessment, your first task is to scan the network systems/devices connected to the target network within a specified IP range and check for ***live*** systems in the target network.

Scansione Probe Only:
> nmap -v -sn 192.168.1.15

This is the standard mode to do a Host Discovery.\
E' Possibile personalizzare le richieste con dei Flag per avere piu controllo(via UDP, TCP, ARP etc)[qui](https://nmap.org/man/it/man-host-discovery.html)

Example with UDP scan:
> nmap -v -sn -PU [Target IP]

## Port Scanning and Service Discovery
The next step after discovering active hosts in the target network is to scan for open ports and services running on the target IP addresses in the target network.

- Scansione TCP scan

  TCP Scan completes the Three-Way Handshake which may triggers ids or other protection systems
  ```
  nmap -v -sT [Target IP]
  ```

- Scansione Stealth scan

  THe Stealth Scan option involves resetting the connection after the Syn-Ack response from the target machine, since the connection is not completed we **may** successfully evade ips rules or any **logging systems**
  ```
  nmap -v -sS [TARGET IP]
  ```

- Scansione IDLE/ID
    ```
    nmap -v -Pn -p- -sI HostZombie 192.168.1.15
    ```

- Scansione Version scan
    Try to detect service and version
   ```
   nmap -v -sV 192.168.1.15
   ```

- TCP Maimon scan
    ```
    nmap -sM -v [Target IP Address]
    ```
    > Note: In the TCP Maimon scan, a FIN/ACK probe is sent to the target; if there is no response, then the port is Open|Filtered, but if the RST packet is sent as a response, then the port is closed.
- XMAs Scan
    ```
    nmap -sX -v [Target IP Address]
    ```
    > Note: Xmas scan sends a TCP frame to a target system with FIN, URG, and PUSH flags set. If the target has opened the port, then you will receive no response from the target system. If the target has closed the port, then you will receive a target system reply with an RST.

- Scansione con Decoy (Evading IDS)
    ```
    nmap -v -D RND:20 192.168.1.15
    ```

- Scansione con mac spoof (Evading IDS)
    ```
    nmap –sS –PN –spoof-mac 0 192.168.0.30
    ```

- Scansione UDP
    ```
    nmap -v -sU 192.168.1.15
    ```
- Aggressive Scan
    ```
    nmap -A -v [Target IP]
    ```

## Other Scan Methods Worth Mentioning

IDLE/IPID Header Scan: A TCP port scan method that can be used to send a spoofed source address to a computer to discover what services are available.

```
nmap -sI -v [target IP address]
```

SCTP INIT Scan: An INIT chunk is sent to the target host; an INIT+ACK chunk response implies that the port is open, and an ABORT Chunk response means that the port is closed.
```
nmap -sY -v [target IP address]
```

SCTP COOKIE ECHO Scan: A COOKIE ECHO chunk is sent to the target host; no response implies that the port is open and ABORT Chunk response means that the port is closed.
```
nmap -sZ -v [target IP address]
```

## Nmap Scripts


smb-os-discovery.nse: attempts to determine the OS, computer name, domain, workgroup, and current time over the SMB protocol (ports 445 or 139).
```
nmap --script smb-os-discovery.nse [Target IP Address]
```

Scan for a range variety of vulnarbilities
```
nmap --script vuln [Target IP]
```